<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Calcul mât & espacement – Éclairage public</title>
<link rel="stylesheet" href="style.css">
<script src="menu.js" defer></script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/sw.js");
  }
<style>
  :root{
    --bg:#0f172a; --card:#111827; --ink:#e5e7eb; --muted:#94a3b8;
    --accent:#22d3ee; --road:#4b5563; --kerb:#9ca3af; --grass:#14532d;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;
    background:linear-gradient(180deg,#0b1224,#0f172a 120px);
    color:var(--ink); min-height:100vh; display:flex; flex-direction:column; gap:18px;
  }
  header{padding:18px 22px}
  header h1{margin:0; font-size:clamp(18px,2.5vw,24px); font-weight:650}
  main{display:grid; grid-template-columns:minmax(280px,420px) 1fr; gap:18px; padding:0 22px 24px}
  @media(max-width:900px){main{grid-template-columns:1fr}}
  .card{
    background:linear-gradient(180deg,#0f172a 0%,#0b1224 100%);
    border:1px solid #1f2937; border-radius:16px; padding:18px;
    box-shadow:0 8px 30px rgba(0,0,0,.35);
  }
  label{display:block; font-size:14px; color:var(--muted); margin-bottom:6px}
  input[type="number"],input[type="range"]{
    width:100%; background:#0b1224; color:var(--ink);
    border:1px solid #253048; border-radius:10px; padding:10px 12px; font-size:16px; outline:none;
  }
  input[type="range"]{height:36px; padding:0}
  .row{display:grid; grid-template-columns:1fr auto; gap:10px; align-items:center}
  .val{font-variant-numeric:tabular-nums; font-weight:700; color:var(--accent)}
  .grid-2{display:grid; grid-template-columns:1fr 1fr; gap:12px}
  .hint{font-size:12px; color:var(--muted)}
  .kpi{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px}
  .kpi .box{
    background:#0b1224; border:1px dashed #273043; border-radius:12px; padding:12px
  }
  .box h3{margin:0; font-size:13px; color:var(--muted)}
  .box p{margin:6px 0 0; font-size:22px; color:var(--accent); font-weight:800}
  .scene-wrap{position:relative}
  .legend{
    position:absolute; top:10px; left:10px; font-size:12px; color:var(--muted);
    background:#0b1224AA; backdrop-filter:blur(2px);
    border:1px solid #253048; border-radius:10px; padding:8px 10px
  }
  .scene{
    position:relative; width:100%; height:520px; border-radius:16px; overflow:hidden;
    background:radial-gradient(1200px 420px at 60% 0%,#0f172a 0%,#0b1224 60%,#09111f 100%);
    border:1px solid #1f2937;
  }
  .terrain{position:absolute; inset:0; display:grid; grid-template-rows:1fr auto 1fr}
  .grass{background:repeating-linear-gradient(90deg,#0f2c1c,#0f2c1c 20px,#103422 20px,#103422 40px)}
  .road{
    height:160px; background:linear-gradient(#6b7280,#4b5563 40%,#4b5563 60%,#6b7280);
    border-top:8px solid var(--kerb); border-bottom:8px solid var(--kerb); position:relative
  }
  .road::before,.road::after{
    content:""; position:absolute; left:0; right:0; top:calc(50% - 2px); height:4px;
    background:repeating-linear-gradient(90deg,#e5e7eb 0 30px,transparent 30px 60px); opacity:.8
  }
  .lane-dim{
    position:absolute; right:10px; top:-60px; width:6px; background:#22d3ee; height:0;
    transform-origin:bottom; border-radius:3px;
  }
  .lane-dim::after{
    content:attr(data-h) " m"; position:absolute; left:10px; top:-16px; font-size:12px; color:var(--ink);
    background:#0b1224; padding:2px 6px; border:1px solid #253048; border-radius:8px
  }
  .lamp{
    position:absolute; bottom:160px; width:50px; transform:translateX(-50%);
    display:flex; flex-direction:column; align-items:center; gap:4px
  }
  .mast{
    width:8px; height:120px; background:linear-gradient(#0b0f17,#111827);
    border:1px solid #1f2937; border-radius:4px 4px 2px 2px; position:relative;
  }
  .mast::after{
    content:""; position:absolute; top:-26px; left:50%; transform:translateX(-50%);
    width:26px; height:26px; background:radial-gradient(#fde68a,#fbbf24 60%,#f59e0b);
    border:2px solid #1f2937; border-radius:6px 6px 18px 18px; box-shadow:0 0 24px 6px #fde68a66
  }
  .lamp .h-label{
    font-size:12px; color:var(--muted); background:#0b1224; border:1px solid #253048;
    padding:2px 6px; border-radius:8px
  }
  .measure{
    position:absolute; bottom:200px; left:0; right:0; height:0; border-bottom:2px dashed #22d3ee;
  }
  .measure::after{
    content:attr(data-e) " m"; position:absolute; left:50%; transform:translate(-50%,10px);
    font-size:12px; color:var(--ink); background:#0b1224;
    padding:2px 6px; border:1px solid #253048; border-radius:8px
  }
  footer{padding:0 22px 26px; color:var(--muted); font-size:12px}
</style>
</head>
<body>
<header>
  <h1>Calcul de la hauteur d’un mât et de l’espacement entre deux candélabres</h1>
</header>

<main>
  <section class="card">
    <div class="row" style="margin-bottom:10px;">
      <label for="w">Largeur de la route (m)</label>
      <span class="val" id="wOut">12,0</span>
    </div>
    <div class="grid-2" style="margin-bottom:14px;">
      <input id="w" type="range" min="2" max="40" step="0.1" value="18">
      <input id="wNum" type="number" min="2" max="40" step="0.1" value="18">
    </div>
    <p class="hint">Formules utilisées : H = 0,8 × largeur ; e = 5 × H</p>

    <div class="kpi">
      <div class="box">
        <h3>Hauteur du mât (H)</h3>
        <p><span id="hVal">4</span> m</p>
      </div>
      <div class="box">
        <h3>Espacement entre mâts (e)</h3>
        <p><span id="eVal">20</span> m</p>
      </div>
    </div>
    <div class="kpi">
      <div class="box">
        <h3>H arrondi</h3>
        <p><span id="hRound">4</span> m</p>
      </div>
      <div class="box">
        <h3>e arrondi</h3>
        <p><span id="eRound">20</span> m</p>
      </div>
    </div>
  </section>

  <section class="card scene-wrap">
    <div class="legend">Visualisation à l’échelle : 1 m ≈ <span class="val" id="scalePx">8</span> px</div>
    <div class="scene" id="scene">
      <div class="terrain">
        <div class="grass"></div>
        <div class="road" id="road">
          <div class="lane-dim" id="hBar" data-h="H"></div>
        </div>
        <div class="grass"></div>
      </div>
      <div class="measure" id="measure" data-e="e"></div>
      <div class="lamp" id="lampA" style="left:15%;">
        <div class="mast" id="mastA"></div>
        <div class="h-label" id="hTextA">H</div>
      </div>
      <div class="lamp" id="lampB" style="left:50%;">
        <div class="mast" id="mastB"></div>
        <div class="h-label" id="hTextB">H</div>
      </div>
    </div>
  </section>
</main>

<footer>
  Astuce : faites glisser le curseur ou tapez une valeur précise de largeur de route pour voir la hauteur des mâts et l’espacement se mettre à jour, ainsi que la scène.
</footer>

<script>
(function(){
  const $ = (id)=>document.getElementById(id);

  const wRange=$("w"),wNum=$("wNum"),wOut=$("wOut"),hVal=$("hVal"),eVal=$("eVal"),
        hRound=$("hRound"),eRound=$("eRound"),
        mastA=$("mastA"),mastB=$("mastB"),
        hTextA=$("hTextA"),hTextB=$("hTextB"),
        measure=$("measure"),scene=$("scene"),hBar=$("hBar"),scalePxText=$("scalePx");

  const fmt=(n,d=1)=>n.toLocaleString('fr-CH',{minimumFractionDigits:d,maximumFractionDigits:d});

  function getScalePx(){
    const w=Number(wRange.value);
    const maxE=5*(0.8*w);
    const usable=scene.clientWidth*0.7;
    return Math.max(4,Math.min(16,usable/maxE));
  }

  function update(){
    const w=Number(wRange.value);
    wNum.value=w;
    wOut.textContent=fmt(w,1);

    const H=0.8*w;
    const e=5*H;

    hVal.textContent=fmt(H,1);
    eVal.textContent=fmt(e,1);
    hRound.textContent=Math.round(H);
    eRound.textContent=Math.round(e);

    const S=getScalePx();
    scalePxText.textContent=Math.round(S);

    const mastPx=Math.max(40,H*S);
    [mastA,mastB].forEach(m=>m.style.height=mastPx+"px");
    hTextA.textContent="H = "+fmt(H,1)+" m";
    hTextB.textContent="H = "+fmt(H,1)+" m";

    const center=scene.clientWidth*0.5;
    const pxE=e*S;

    const left=Math.max(90,center-pxE/2);
    const right=Math.min(scene.clientWidth-90,center+pxE/2);

    $("lampA").style.left=left+"px";
    $("lampB").style.left=right+"px";

    measure.style.left=left+"px";
    measure.style.right=(scene.clientWidth-right)+"px";
    measure.setAttribute("data-e","e = "+fmt(e,1)+" m");

    hBar.style.height=(H*S)+"px";
    hBar.setAttribute("data-h","H = "+fmt(H,1));
  }

  wRange.addEventListener('input',update);
  wNum.addEventListener('input',()=>{
    let v=parseFloat(wNum.value||0);
    if(isNaN(v))v=18;
    v=Math.max(2,Math.min(40,v));
    wRange.value=v;
    update();
  });

  window.addEventListener('resize',update,{passive:true});
  update();
})();
</script>
</body>
</html>



